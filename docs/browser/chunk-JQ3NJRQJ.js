import{a as Ue,b as Je}from"./chunk-W5IJN7S4.js";import{a as Ne}from"./chunk-D5FJQBOJ.js";import{a as De,b as Oe}from"./chunk-LOMW4U7G.js";import{e as Xe,i as Ye}from"./chunk-B3R2HNO2.js";import{a as ze,e as $e,f as He,g as Ke,i as Ze,j as We}from"./chunk-A5Y6S3FO.js";import{b as qe,f as Ve,i as Fe,o as Qe}from"./chunk-NCISI33M.js";import{g as Z,h as Pe,i as Be,k as W}from"./chunk-7MM4KBRY.js";import{c as je,d as U,f as j,g as J,i as X}from"./chunk-5IC5DNT2.js";import{$ as K,S as Se,T as Ie,U as Re,W as Ee,Y as B,a as Ce,r as Ae,s as Te,z as Me}from"./chunk-6BJC2WJD.js";import{a as Le}from"./chunk-BLA6EKOB.js";import{a as H,b as ve,h as we,k as ye}from"./chunk-KH54WQ6O.js";import{$ as D,Aa as ne,Ab as d,Bb as I,Cb as le,Db as de,Dc as _e,Ec as xe,Fb as y,Fc as ke,Hb as me,Ib as C,Jb as he,Kb as h,Ob as q,Pb as V,Qb as F,Rb as ue,Sb as p,Tb as Q,Ua as ie,Ub as A,Vb as pe,Wb as N,X as te,Xa as c,Xb as z,Ya as f,Yb as $,_a as se,_b as R,a as v,b as Y,ca as L,d as G,ea as _,eb as oe,ec as fe,fa as O,j as w,ja as M,kb as ae,la as P,mc as be,pb as b,qb as re,rb as u,sa as x,t as ee,ta as k,vb as ce,ya as S,yc as ge,zb as l}from"./chunk-CU6XLLBJ.js";var et=(()=>{let i=class i{constructor(e){this.http=e,this.baseUrl=Le.questionApiUrl}listQuestions(e,t){let n=new H;return e&&(n=n.set("limit",e.toString())),t&&Object.keys(t).forEach(s=>{n=n.set(s,t[s])}),this.http.get(`${this.baseUrl}`,{params:n})}listTrainingQuestions(e,t){let n=new H().set("limit",e.toString());return t&&t.length>0&&(n=n.set("categories",t.join(","))),this.http.get(`${this.baseUrl}/training`,{params:n})}getQuestionById(e){return this.http.get(`${this.baseUrl}/${e}`)}};i.\u0275fac=function(t){return new(t||i)(_(ve))},i.\u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();function ot(o,i){if(o&1){let r=y();l(0,"div",1)(1,"button",2),C("click",function(){x(r);let t=h();return k(t.action())}),p(2),d()()}if(o&2){let r=h();c(2),A(" ",r.data.action," ")}}var at=["label"];function rt(o,i){}var ct=Math.pow(2,31)-1,E=class{constructor(i,r){this._overlayRef=r,this._afterDismissed=new w,this._afterOpened=new w,this._onAction=new w,this._dismissedByAction=!1,this.containerInstance=i,i._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(i){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(i,ct))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},tt=new L("MatSnackBarData"),T=class{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}},lt=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=P({type:i,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"],standalone:!0});let o=i;return o})(),dt=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=P({type:i,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"],standalone:!0});let o=i;return o})(),mt=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=P({type:i,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"],standalone:!0});let o=i;return o})(),ht=(()=>{let i=class i{constructor(e,t){this.snackBarRef=e,this.data=t}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}};i.\u0275fac=function(t){return new(t||i)(f(E),f(tt))},i.\u0275cmp=M({type:i,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],standalone:!0,features:[R],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(t,n){t&1&&(l(0,"div",0),p(1),d(),b(2,ot,3,1,"div",1)),t&2&&(c(),A(" ",n.data.message,`
`),c(),ce(n.hasAction?2:-1))},dependencies:[B,lt,dt,mt],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0});let o=i;return o})(),ut={snackBarState:je("state",[J("void, hidden",j({transform:"scale(0.8)",opacity:0})),J("visible",j({transform:"scale(1)",opacity:1})),X("* => visible",U("150ms cubic-bezier(0, 0, 0.2, 1)")),X("* => void, * => hidden",U("75ms cubic-bezier(0.4, 0.0, 1, 1)",j({opacity:0})))])},pt=0,ft=(()=>{let i=class i extends Be{constructor(e,t,n,s,a){super(),this._ngZone=e,this._elementRef=t,this._changeDetectorRef=n,this._platform=s,this.snackBarConfig=a,this._document=O(ge),this._trackedModals=new Set,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new w,this._onExit=new w,this._onEnter=new w,this._animationState="void",this._liveElementId=`mat-snack-bar-container-live-${pt++}`,this.attachDomPortal=m=>{this._assertNotAttached();let g=this._portalOutlet.attachDomPortal(m);return this._afterPortalAttached(),g},a.politeness==="assertive"&&!a.announcementMessage?this._live="assertive":a.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();let t=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),t}attachTemplatePortal(e){this._assertNotAttached();let t=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),t}onAnimationEnd(e){let{fromState:t,toState:n}=e;if((n==="void"&&t!=="void"||n==="hidden")&&this._completeExit(),n==="visible"){let s=this._onEnter;this._ngZone.run(()=>{s.next(),s.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let e=this._elementRef.nativeElement,t=this.snackBarConfig.panelClass;t&&(Array.isArray(t)?t.forEach(a=>e.classList.add(a)):e.classList.add(t)),this._exposeToModals();let n=this._label.nativeElement,s="mdc-snackbar__label";n.classList.toggle(s,!n.querySelector(`.${s}`))}_exposeToModals(){let e=this._liveElementId,t=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let n=0;n<t.length;n++){let s=t[n],a=s.getAttribute("aria-owns");this._trackedModals.add(s),a?a.indexOf(e)===-1&&s.setAttribute("aria-owns",a+" "+e):s.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{let t=e.getAttribute("aria-owns");if(t){let n=t.replace(this._liveElementId,"").trim();n.length>0?e.setAttribute("aria-owns",n):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{let e=this._elementRef.nativeElement.querySelector("[aria-hidden]"),t=this._elementRef.nativeElement.querySelector("[aria-live]");if(e&&t){let n=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(n=document.activeElement),e.removeAttribute("aria-hidden"),t.appendChild(e),n?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}};i.\u0275fac=function(t){return new(t||i)(f(oe),f(ne),f(be),f(Ce),f(T))},i.\u0275cmp=M({type:i,selectors:[["mat-snack-bar-container"]],viewQuery:function(t,n){if(t&1&&(q(W,7),q(at,7)),t&2){let s;V(s=F())&&(n._portalOutlet=s.first),V(s=F())&&(n._label=s.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:1,hostBindings:function(t,n){t&1&&he("@state.done",function(a){return n.onAnimationEnd(a)}),t&2&&me("@state",n._animationState)},standalone:!0,features:[ae,R],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(t,n){t&1&&(l(0,"div",1)(1,"div",2,0)(3,"div",3),b(4,rt,0,0,"ng-template",4),d(),I(5,"div"),d()()),t&2&&(c(5),re("aria-live",n._live)("role",n._role)("id",n._liveElementId))},dependencies:[W],styles:[".mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}.cdk-high-contrast-active .mat-mdc-snackbar-surface{outline:solid 1px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mdc-snackbar-supporting-text-color);border-radius:var(--mdc-snackbar-container-shape);background-color:var(--mdc-snackbar-container-color)}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mdc-snackbar-supporting-text-font);font-size:var(--mdc-snackbar-supporting-text-size);font-weight:var(--mdc-snackbar-supporting-text-weight);line-height:var(--mdc-snackbar-supporting-text-line-height)}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){color:var(--mat-snack-bar-button-color);--mat-text-button-state-layer-color:currentColor;--mat-text-button-ripple-color:currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}"],encapsulation:2,data:{animation:[ut.snackBarState]}});let o=i;return o})();function bt(){return new T}var gt=new L("mat-snack-bar-default-options",{providedIn:"root",factory:bt}),nt=(()=>{let i=class i{get _openedSnackBarRef(){let e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(e,t,n,s,a,m){this._overlay=e,this._live=t,this._injector=n,this._breakpointObserver=s,this._parentSnackBar=a,this._defaultConfig=m,this._snackBarRefAtThisLevel=null,this.simpleSnackBarComponent=ht,this.snackBarContainerComponent=ft,this.handsetCssClass="mat-mdc-snack-bar-handset"}openFromComponent(e,t){return this._attach(e,t)}openFromTemplate(e,t){return this._attach(e,t)}open(e,t="",n){let s=v(v({},this._defaultConfig),n);return s.data={message:e,action:t},s.announcementMessage===e&&(s.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,s)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,t){let n=t&&t.viewContainerRef&&t.viewContainerRef.injector,s=S.create({parent:n||this._injector,providers:[{provide:T,useValue:t}]}),a=new Z(this.snackBarContainerComponent,t.viewContainerRef,s),m=e.attach(a);return m.instance.snackBarConfig=t,m.instance}_attach(e,t){let n=v(v(v({},new T),this._defaultConfig),t),s=this._createOverlay(n),a=this._attachSnackBarContainer(s,n),m=new E(a,s);if(e instanceof se){let g=new Pe(e,null,{$implicit:n.data,snackBarRef:m});m.instance=a.attachTemplatePortal(g)}else{let g=this._createInjector(n,m),it=new Z(e,void 0,g),st=a.attachComponentPortal(it);m.instance=st.instance}return this._breakpointObserver.observe(Te.HandsetPortrait).pipe(te(s.detachments())).subscribe(g=>{s.overlayElement.classList.toggle(this.handsetCssClass,g.matches)}),n.announcementMessage&&a._onAnnounce.subscribe(()=>{this._live.announce(n.announcementMessage,n.politeness)}),this._animateSnackBar(m,n),this._openedSnackBarRef=m,this._openedSnackBarRef}_animateSnackBar(e,t){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),t.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),t.duration&&t.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(t.duration))}_createOverlay(e){let t=new Xe;t.direction=e.direction;let n=this._overlay.position().global(),s=e.direction==="rtl",a=e.horizontalPosition==="left"||e.horizontalPosition==="start"&&!s||e.horizontalPosition==="end"&&s,m=!a&&e.horizontalPosition!=="center";return a?n.left("0"):m?n.right("0"):n.centerHorizontally(),e.verticalPosition==="top"?n.top("0"):n.bottom("0"),t.positionStrategy=n,this._overlay.create(t)}_createInjector(e,t){let n=e&&e.viewContainerRef&&e.viewContainerRef.injector;return S.create({parent:n||this._injector,providers:[{provide:E,useValue:t},{provide:tt,useValue:e.data}]})}};i.\u0275fac=function(t){return new(t||i)(_(Ye),_(Me),_(S),_(Ae),_(i,12),_(gt))},i.\u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();function xt(o,i){if(o&1&&(l(0,"span"),p(1),d()),o&2){let r=h(2);c(),A("Zeit: ",r.elapsedTime,"")}}function kt(o,i){if(o&1&&(l(0,"span"),p(1),d()),o&2){let r=h(2);c(),Q(r.countdownTime)}}function vt(o,i){if(o&1&&(l(0,"div")(1,"div"),p(2),d()()),o&2){let r=h(2);c(2),Q(r.currentQuestionResult.question)}}function wt(o,i){if(o&1){let r=y();l(0,"li")(1,"mat-checkbox",16),$("ngModelChange",function(t){let n=x(r).index,s=h(3);return z(s.currentQuestionResult.givenAnswers[n],t)||(s.currentQuestionResult.givenAnswers[n]=t),k(t)}),p(2),d()()}if(o&2){let r=i.$implicit,e=i.index,t=h(3);c(),u("id","answer-checkbox-"+e),N("ngModel",t.currentQuestionResult.givenAnswers[e]),u("disabled",t.currentQuestionResult.isValidated)("ngClass",t.getCheckboxClass(e)),c(),A(" ",r.answer," ")}}function yt(o,i){if(o&1&&(l(0,"section",14)(1,"ul"),b(2,wt,3,5,"li",15),d()()),o&2){let r=h(2);c(2),u("ngForOf",r.currentQuestionResult==null?null:r.currentQuestionResult.answers)}}function Ct(o,i){if(o&1){let r=y();l(0,"section",17)(1,"div",18)(2,"mat-form-field",19)(3,"mat-label"),p(4,"Antwort hier eingeben"),d(),l(5,"textarea",20),$("ngModelChange",function(t){x(r);let n=h(2);return z(n.currentQuestionResult.givenAnswer,t)||(n.currentQuestionResult.givenAnswer=t),k(t)}),p(6,"            "),d()()(),I(7,"div",21),d()}if(o&2){let r=h(2);c(2),u("ngClass",r.getAnswerClass()),c(3),u("disabled",r.currentQuestionResult.isValidated),N("ngModel",r.currentQuestionResult.givenAnswer),c(2),u("innerHTML",r.currentQuestionResult.formattedAnswer,ie)}}function At(o,i){if(o&1){let r=y();l(0,"button",11),C("click",function(){x(r);let t=h(2);return k(t.checkAnswer())}),l(1,"mat-icon"),p(2,"rule"),d()()}if(o&2){let r=h(2);u("disabled",r.currentQuestionResult.isValidated)}}function Tt(o,i){if(o&1){let r=y();le(0),l(1,"div",2)(2,"mat-card",3)(3,"section",4)(4,"mat-card-header")(5,"mat-card-title")(6,"span"),p(7),d(),b(8,xt,2,1,"span",5)(9,kt,2,1,"span",5),d()(),l(10,"mat-card-content"),b(11,vt,3,1,"div",5),d()()(),l(12,"mat-card",6)(13,"mat-card-content"),b(14,yt,3,1,"section",7)(15,Ct,8,4,"section",8),d()()(),l(16,"div",9)(17,"div",10)(18,"button",11),C("click",function(){x(r);let t=h();return k(t.preQuestion())}),l(19,"mat-icon"),p(20,"arrow_back_ios"),d()(),b(21,At,3,1,"button",12),l(22,"button",11),C("click",function(){x(r);let t=h();return k(t.nextQuestion())}),l(23,"mat-icon"),p(24,"arrow_forward_ios"),d()(),l(25,"button",13),C("click",function(){x(r);let t=h();return k(t.endTest())}),l(26,"mat-icon"),p(27,"exit_to_app"),d()()()(),de()}if(o&2){let r,e=h();c(7),pe("Frage ",e.currentQuestionIndex+1," / ",e.questionResultList.length,""),c(),u("ngIf",!e.isExam),c(),u("ngIf",e.isExam),c(2),u("ngIf",e.currentQuestionResult),c(3),u("ngIf",(r=e.currentQuestionResult==null||e.currentQuestionResult.answers==null?null:e.currentQuestionResult.answers.length)!==null&&r!==void 0?r:!1),c(),u("ngIf",e.currentQuestionResult==null?null:e.currentQuestionResult.answer),c(3),u("disabled",e.currentQuestionIndex<1),c(3),u("ngIf",!e.isExam),c(),u("disabled",e.currentQuestionIndex>=e.questionResultList.length-1)}}function Mt(o,i){o&1&&(l(0,"p"),p(1,"Update Fragenkatalog..."),d(),I(2,"mat-progress-bar",22))}var Rn=(()=>{let i=class i{constructor(e,t,n){this.router=e,this.sanitizer=t,this.snackBar=n,this.questionService=O(et),this.currentQuestionIndex=0,this.questionResultList=[],this.loading=!0,this.isExam=!1,this.elapsedTime="00:00:00",this.countdownTime="01:30:00";let a=this.router.getCurrentNavigation()?.extras.state;this.navigationParameter={limit:a.sliderValue,categories:a.categoryNames,isExam:a.isExam},this.currentQuestionResult=this.getNewQuestionResult(),this.startDate=new Date,this.endDate=new Date}ngOnInit(){return G(this,null,function*(){try{console.log("getting catalog questions");let e=yield ee(this.questionService.listTrainingQuestions(this.navigationParameter.limit,this.navigationParameter.categories));console.log("got list"),this.questionResultList=this.createQuestionResultList(e),this.currentQuestionResult=this.questionResultList[0],this.isExam=this.navigationParameter.isExam,this.loading=!1,this.isExam?this.startCountdown():this.startRegularTimer()}catch(e){console.error("Error fetching questions",e),this.loading=!0,this.showErrorAndNavigateHome()}})}getNewQuestionResult(){return{id:"",category:"",subCategory:"",externalId:"",question:"",answer:"",givenAnswer:"",formattedAnswer:"",answers:[],givenAnswers:[],mustKeywords:[],missingKeywords:[],isValidated:!1,isCorrect:!1,isAnswered:!1,isExamRelevant:!1,errorValue:0}}ngOnDestroy(){clearInterval(this.timerInterval)}startRegularTimer(){this.timerInterval=setInterval(()=>{this.updateElapsedTime()},1e3)}updateElapsedTime(){let t=new Date().getTime()-this.startDate.getTime(),n=Math.floor(t/36e5),s=Math.floor(t%36e5/6e4),a=Math.floor(t%6e4/1e3);this.elapsedTime=`${this.padZero(n)}:${this.padZero(s)}:${this.padZero(a)}`}startCountdown(){this.endDate=new Date(new Date().getTime()+90*6e4),this.timerInterval=setInterval(()=>{this.updateCountdownTime()},1e3)}updateCountdownTime(){let e=new Date,t=this.endDate.getTime()-e.getTime();if(t<=0)clearInterval(this.timerInterval),this.countdownTime="00:00:00",this.endTest();else{let n=Math.floor(t/36e5),s=Math.floor(t%36e5/6e4),a=Math.floor(t%6e4/1e3);this.countdownTime=`${this.padZero(n)}:${this.padZero(s)}:${this.padZero(a)}`}}padZero(e){return e<10?"0"+e:e.toString()}endTest(){let e={endDate:new Date,questionResultList:this.questionResultList,startDate:this.startDate,inCorrectQuestions:0,passedTest:!0,isExam:this.isExam,questionAmount:this.questionResultList.length,answeredQuestions:0,correctAnswers:0,incorrectAnswers:0,requiredTime:"00:00:00"};this.questionResultList.forEach(t=>{let n;this.questionResultList.some(s=>s.id===t.id?(this.validateAnswer(s),!0):!1)||(n=this.getNewQuestionResult(),this.validateAnswer(n))}),e.answeredQuestions=this.questionResultList.filter(t=>t.isAnswered).length,e.correctAnswers=this.questionResultList.filter(t=>t.isCorrect).length,e.incorrectAnswers=this.questionResultList.filter(t=>!t.isCorrect).length,e.requiredTime=this.calculateRequiredTime(e),this.router.navigate(["/testresult"],{state:{testResult:e}})}nextQuestion(){this.currentQuestionIndex<this.questionResultList.length-1&&(this.currentQuestionResult.isValidated||this.updateCurrentQuestionResultInList(this.currentQuestionResult),console.log("list:"+JSON.stringify(this.questionResultList,null,2)),this.currentQuestionIndex++,this.currentQuestionResult=this.questionResultList[this.currentQuestionIndex])}preQuestion(){this.currentQuestionIndex>0&&(this.currentQuestionResult.isValidated||this.updateCurrentQuestionResultInList(this.currentQuestionResult),console.log("list:"+JSON.stringify(this.questionResultList,null,2)),this.currentQuestionIndex--,this.currentQuestionResult=this.questionResultList[this.currentQuestionIndex])}checkAnswer(){console.log("check"),console.log("Result:"+JSON.stringify(this.currentQuestionResult,null,2)),this.currentQuestionResult?.isValidated||this.validateAnswer(this.currentQuestionResult)}validateAnswer(e){e.isValidated=!0,e?.answer?.length>0?this.validateTextAnswer(e):this.validateCheckBoxAnswers(e),this.updateCurrentQuestionResultInList(e),console.log("Validated:"+JSON.stringify(e,null,2))}validateCheckBoxAnswers(e){e.isCorrect=!0;for(let t=0;t<e.answers.length;t++)if(console.log("Answer "+t+": "+e.answers[t].isChecked+" givenAnswer: "+e.givenAnswers[t]),!!e.answers[t].isChecked!=!!e.givenAnswers[t]){e.isCorrect=!1;break}}validateTextAnswer(e){if(e?.mustKeywords?.length>0){console.log("keywords: "+JSON.stringify(e.mustKeywords,null,2)),e.givenAnswer==null||e.givenAnswer.length===0?e.missingKeywords=e.mustKeywords.map(s=>this.stringToSearchRegex(s)):(e.isCorrect=!0,e.mustKeywords.forEach(s=>{let a=this.stringToSearchRegex(s);a.test(e.givenAnswer)||(e.isCorrect=!1,e.missingKeywords.push(a))}));let t=s=>`/${s.source}/${s.flags}`,n=e.missingKeywords.map(t);console.log("missing words: "+JSON.stringify(n,null,2))}else e.answer===e.givenAnswer&&(e.isCorrect=!0);e.isCorrect&&e.mustKeywords.length>0&&e.answer.length>0?this.formatCorrectAnswer(e,e):this.formatIncorrectAnswer(e,e)}getCheckboxClass(e){return this.currentQuestionResult.isValidated?this.currentQuestionResult.answers[e].isChecked===(this.currentQuestionResult.givenAnswers[e]??!1)?"correct-checkbox":"incorrect-checkbox":""}getAnswerClass(){return this.currentQuestionResult.isValidated?this.currentQuestionResult.isCorrect?"correct-answer":"incorrect-answer":""}formatCorrectAnswer(e,t){let n=e.answer,s=e.mustKeywords.map(m=>m.toLowerCase().trim()),a=n.replaceAll(`
`,"<br>").split(" ").map(m=>s.includes(m.toLowerCase().trim())?`<strong>${m}</strong>`:m).join(" ");console.log("format before Dom: "+JSON.stringify(a,null,2)),t.formattedAnswer=this.sanitizer.bypassSecurityTrustHtml(a)}formatIncorrectAnswer(e,t){let s=e.answer.replaceAll(`
`,"<br>").split(" ").map(a=>t.missingKeywords.find(g=>g.test(a))!==void 0?`<span style="color: red;">${a}</span>`:a).join(" ");console.log("format before Dom: "+JSON.stringify(s,null,2)),t.formattedAnswer=this.sanitizer.bypassSecurityTrustHtml(s)}updateCurrentQuestionResultInList(e){(e.givenAnswers.some(t=>t)||e.givenAnswer.length>0)&&(e.isAnswered=!0)}stringToSearchRegex(e){let t;if(e.startsWith("!")){let n=e.substring(1);t=`\\b(?!${this.replaceSpecialChars(n)}\\b).*$`}else e.includes("|")?t=`(${e.split("|").map(s=>this.replaceSpecialChars(s.trim())).join("|")})`:t=`${this.replaceSpecialChars(e)}`;return new RegExp(t,"i")}replaceSpecialChars(e){let t=/[äüöß]/g;return e.replace(t,".*")}calculateRequiredTime(e){let t=e.endDate.getTime()-e.startDate.getTime(),n=Math.floor(t/36e5),s=Math.floor(t%36e5/6e4),a=Math.floor(t%6e4/1e3);return`${this.padZero(n)}:${this.padZero(s)}:${this.padZero(a)}`}showErrorAndNavigateHome(){this.snackBar.open("Fehler beim updaten der Fragen. Weiterleitung zur Haauptseite... nach 5 Sekunden","",{duration:5e3}),setTimeout(()=>{this.router.navigate(["/home"])},5e3)}createQuestionResultList(e){return e.map(t=>this.createQuestionResult(t))}createQuestionResult(e){return Y(v({},e),{givenAnswer:"",givenAnswers:[],formattedAnswer:"",missingKeywords:[],isCorrect:!1,isValidated:!1,isAnswered:!1})}};i.\u0275fac=function(t){return new(t||i)(f(ye),f(we),f(nt))},i.\u0275cmp=M({type:i,selectors:[["app-train"]],standalone:!0,features:[R],decls:3,vars:2,consts:[["loadingTemplate",""],[4,"ngIf","ngIfElse"],[1,"above-container"],[1,"question-card"],[1,"question-section"],[4,"ngIf"],[1,"answer-card"],["class","answer-checkbox-section",4,"ngIf"],["class","answer-input-section",4,"ngIf"],[1,"fixed-bottom"],[1,"example-button-row"],["mat-stroked-button","",1,"row_button",3,"click","disabled"],["mat-stroked-button","","class","row_button",3,"disabled","click",4,"ngIf"],["mat-stroked-button","",1,"last_row_button",3,"click"],[1,"answer-checkbox-section"],[4,"ngFor","ngForOf"],[3,"ngModelChange","id","ngModel","disabled","ngClass"],[1,"answer-input-section"],[1,"answer-input"],[3,"ngClass"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1","cdkAutosizeMaxRows","10",3,"ngModelChange","disabled","ngModel"],[1,"formatted-answer",3,"innerHTML"],["mode","indeterminate"]],template:function(t,n){if(t&1&&b(0,Tt,28,10,"ng-container",1)(1,Mt,3,0,"ng-template",null,0,fe),t&2){let s=ue(2);u("ngIf",!n.loading)("ngIfElse",s)}},dependencies:[xe,ke,_e,Se,Re,Ne,Ee,Ie,He,$e,ze,We,Ze,Ke,Qe,qe,Ve,Fe,K,B,Oe,De,Je,Ue],styles:[".tertiary-checkbox[_ngcontent-%COMP%]{--mdc-checkbox-disabled-selected-checkmark-color: #fffbff;--mdc-checkbox-selected-focus-state-layer-opacity: .12;--mdc-checkbox-selected-hover-state-layer-opacity: .08;--mdc-checkbox-selected-pressed-state-layer-opacity: .12;--mdc-checkbox-unselected-focus-state-layer-opacity: .12;--mdc-checkbox-unselected-hover-state-layer-opacity: .08;--mdc-checkbox-unselected-pressed-state-layer-opacity: .12;--mdc-checkbox-disabled-selected-icon-color: rgba(29, 27, 30, .38);--mdc-checkbox-disabled-unselected-icon-color: rgba(29, 27, 30, .38);--mdc-checkbox-selected-checkmark-color: #ffffff;--mdc-checkbox-selected-focus-icon-color: #7d00fa;--mdc-checkbox-selected-hover-icon-color: #7d00fa;--mdc-checkbox-selected-icon-color: #7d00fa;--mdc-checkbox-unselected-focus-icon-color: #1d1b1e;--mdc-checkbox-unselected-hover-icon-color: #1d1b1e;--mdc-checkbox-unselected-icon-color: #49454e;--mdc-checkbox-selected-focus-state-layer-color: #7d00fa;--mdc-checkbox-selected-hover-state-layer-color: #7d00fa;--mdc-checkbox-selected-pressed-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-focus-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-hover-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-pressed-state-layer-color: #7d00fa;--mat-checkbox-disabled-label-color: rgba(29, 27, 30, .38);--mat-checkbox-label-text-color: #1d1b1e}.secondary-checkbox[_ngcontent-%COMP%]{--mdc-checkbox-disabled-selected-checkmark-color: #fffbff;--mdc-checkbox-selected-focus-state-layer-opacity: .12;--mdc-checkbox-selected-hover-state-layer-opacity: .08;--mdc-checkbox-selected-pressed-state-layer-opacity: .12;--mdc-checkbox-unselected-focus-state-layer-opacity: .12;--mdc-checkbox-unselected-hover-state-layer-opacity: .08;--mdc-checkbox-unselected-pressed-state-layer-opacity: .12;--mdc-checkbox-disabled-selected-icon-color: rgba(29, 27, 30, .38);--mdc-checkbox-disabled-unselected-icon-color: rgba(29, 27, 30, .38);--mdc-checkbox-selected-checkmark-color: #ffffff;--mdc-checkbox-selected-focus-icon-color: #645b70;--mdc-checkbox-selected-hover-icon-color: #645b70;--mdc-checkbox-selected-icon-color: #645b70;--mdc-checkbox-unselected-focus-icon-color: #1d1b1e;--mdc-checkbox-unselected-hover-icon-color: #1d1b1e;--mdc-checkbox-unselected-icon-color: #49454e;--mdc-checkbox-selected-focus-state-layer-color: #645b70;--mdc-checkbox-selected-hover-state-layer-color: #645b70;--mdc-checkbox-selected-pressed-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-focus-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-hover-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-pressed-state-layer-color: #645b70;--mat-checkbox-disabled-label-color: rgba(29, 27, 30, .38);--mat-checkbox-label-text-color: #1d1b1e}.primary-checkbox[_ngcontent-%COMP%]{--mdc-checkbox-disabled-selected-checkmark-color: #fffbff;--mdc-checkbox-selected-focus-state-layer-opacity: .12;--mdc-checkbox-selected-hover-state-layer-opacity: .08;--mdc-checkbox-selected-pressed-state-layer-opacity: .12;--mdc-checkbox-unselected-focus-state-layer-opacity: .12;--mdc-checkbox-unselected-hover-state-layer-opacity: .08;--mdc-checkbox-unselected-pressed-state-layer-opacity: .12;--mdc-checkbox-disabled-selected-icon-color: rgba(29, 27, 30, .38);--mdc-checkbox-disabled-unselected-icon-color: rgba(29, 27, 30, .38);--mdc-checkbox-selected-checkmark-color: #ffffff;--mdc-checkbox-selected-focus-icon-color: #7d00fa;--mdc-checkbox-selected-hover-icon-color: #7d00fa;--mdc-checkbox-selected-icon-color: #7d00fa;--mdc-checkbox-unselected-focus-icon-color: #1d1b1e;--mdc-checkbox-unselected-hover-icon-color: #1d1b1e;--mdc-checkbox-unselected-icon-color: #49454e;--mdc-checkbox-selected-focus-state-layer-color: #7d00fa;--mdc-checkbox-selected-hover-state-layer-color: #7d00fa;--mdc-checkbox-selected-pressed-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-focus-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-hover-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-pressed-state-layer-color: #7d00fa;--mat-checkbox-disabled-label-color: rgba(29, 27, 30, .38);--mat-checkbox-label-text-color: #1d1b1e}.error-checkbox[_ngcontent-%COMP%]{--mdc-checkbox-disabled-selected-checkmark-color: #fffbff;--mdc-checkbox-selected-focus-state-layer-opacity: .12;--mdc-checkbox-selected-hover-state-layer-opacity: .08;--mdc-checkbox-selected-pressed-state-layer-opacity: .12;--mdc-checkbox-unselected-focus-state-layer-opacity: .12;--mdc-checkbox-unselected-hover-state-layer-opacity: .08;--mdc-checkbox-unselected-pressed-state-layer-opacity: .12;--mdc-checkbox-disabled-selected-icon-color: rgba(29, 27, 30, .38);--mdc-checkbox-disabled-unselected-icon-color: rgba(29, 27, 30, .38);--mdc-checkbox-selected-checkmark-color: #ffffff;--mdc-checkbox-selected-focus-icon-color: #ba1a1a;--mdc-checkbox-selected-hover-icon-color: #ba1a1a;--mdc-checkbox-selected-icon-color: #ba1a1a;--mdc-checkbox-unselected-focus-icon-color: #1d1b1e;--mdc-checkbox-unselected-hover-icon-color: #1d1b1e;--mdc-checkbox-unselected-icon-color: #49454e;--mdc-checkbox-selected-focus-state-layer-color: #ba1a1a;--mdc-checkbox-selected-hover-state-layer-color: #ba1a1a;--mdc-checkbox-selected-pressed-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-focus-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-hover-state-layer-color: #1d1b1e;--mdc-checkbox-unselected-pressed-state-layer-color: #ba1a1a;--mat-checkbox-disabled-label-color: rgba(29, 27, 30, .38);--mat-checkbox-label-text-color: #1d1b1e}.question-card[_ngcontent-%COMP%]{margin-bottom:10px}ul[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0}.form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}  .correct-checkbox .mdc-checkbox__background{border-color:#1cc34e!important}  .incorrect-checkbox .mdc-checkbox__background{border-color:#db1010!important}section[_ngcontent-%COMP%]{display:table}.example-label[_ngcontent-%COMP%]{display:table-cell;font-size:14px;margin-left:8px;min-width:120px}.example-flex-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap}.example-button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;width:120px}  .incorrect-answer .mdc-text-field--filled{width:100%;border-color:red;border-width:2px;border-style:groove}  .correct-answer .mdc-text-field--filled{border-color:green;border-width:2px;border-style:groove;background-color:#d1ebec}.answer-input-section[_ngcontent-%COMP%]{display:flex;flex-direction:column}.answer-input[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}.answer-input[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]{min-width:100%!important}.fixed-bottom[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;padding:10px 0 20px}.above-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh}.last_row_button[_ngcontent-%COMP%]{margin-left:5px!important}.mat-mdc-button-base[_ngcontent-%COMP%]{align-items:center;justify-content:center}.example-button-row[_ngcontent-%COMP%]{display:table-cell;max-width:600px}.example-button-row[_ngcontent-%COMP%]   .mat-mdc-button-base[_ngcontent-%COMP%]{margin:4px 4px 4px 0}.mat-mdc-card-title[_ngcontent-%COMP%]{font-size:1.25rem!important;display:flex;justify-content:space-between;min-width:85vw;margin-bottom:10px}"]});let o=i;return o})();export{Rn as TrainComponent};
